<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Remove cardinal biases — remove_cardinal_biases • circhelp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Remove cardinal biases — remove_cardinal_biases"><meta property="og:description" content="Remove cardinal biases"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">circhelp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cardinal_biases.html">Correcting for cardinal biases to improve serial dependence estimates</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove cardinal biases</h1>
    
    <div class="hidden name"><code>remove_cardinal_biases.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Remove cardinal biases</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">remove_cardinal_biases</span><span class="op">(</span>
  <span class="va">err</span>,
  <span class="va">x</span>,
  space <span class="op">=</span> <span class="st">"180"</span>,
  bias_type <span class="op">=</span> <span class="st">"fit"</span>,
  do_plot <span class="op">=</span> <span class="cn">FALSE</span>,
  poly_deg <span class="op">=</span> <span class="fl">4</span>,
  var_sigma <span class="op">=</span> <span class="cn">TRUE</span>,
  var_sigma_poly_deg <span class="op">=</span> <span class="fl">4</span>,
  reassign_at_boundaries <span class="op">=</span> <span class="cn">TRUE</span>,
  reassign_range <span class="op">=</span> <span class="fl">2</span>,
  debug <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>err</dt>
<dd><p>a vector of errors, deviations of response from the true stimuli</p></dd>
<dt>x</dt>
<dd><p>a vector of true stimuli in degrees (see space)</p></dd>
<dt>space</dt>
<dd><p>circular space to use (a string: '180' or '360')</p></dd>
<dt>bias_type</dt>
<dd><p>bias type to use ('fit', 'card', or 'obl', see details)</p></dd>
<dt>do_plot</dt>
<dd><p>show plots (default: False)</p></dd>
<dt>poly_deg</dt>
<dd><p>degree of the fitted polynomials for each bin (default: 4)</p></dd>
<dt>var_sigma</dt>
<dd><p>allow standard deviation (width) of the fitted response distribution to vary as a function of distance to the nearest cardinal (default: True)</p></dd>
<dt>var_sigma_poly_deg</dt>
<dd><p>degree of the fitted polynomials for each bin for the first approximation for the response distribution to select the best fitting model (default: 4)</p></dd>
<dt>reassign_at_boundaries</dt>
<dd><p>select the bin for the observations at the boundaries between bins based on the best-fitting polynomial (default: True)</p></dd>
<dt>reassign_range</dt>
<dd><p>maximum distance to the boundary at which reassignment can occur (default: 2 degrees)</p></dd>
<dt>debug</dt>
<dd><p>print some extra info (default: False)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with the follwing elements:</p><ul><li><p>is_outlier - 0 for outliers (defined as ±3*pred_sigma for the model with varying sigma or as ±3\*SD for the simple model)</p></li>
<li><p>pred predicted error</p></li>
<li><p>be_c error corrected for biases (<code>be_c = observed error - pred</code>)</p></li>
<li><p>which_bin the numeric ID of the bin that the stimulus belong to</p></li>
<li><p>bias the bias computed as described above</p></li>
<li><p>bias_typ bias type (cardinal or oblique)</p></li>
<li><p>pred_lin predicted error for a simple linear model for comparison</p></li>
<li><p>pred_sigma predicted SD of the error distribution</p></li>
<li><p>coef_sigma_int, coef_sigma_slope intercept and slope for the sigma prediction</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the bias_type is set to 'fit', the function computes the cardinal biases in the following way:</p><ol><li><p>Create two sets of bins, splitting the stimuli vector into bins centered at cardinal and at oblique directions.</p></li>
<li><p>For each set of bins, fit a nth-degree polynomial for the responses in each bin, optionally allowing the distribution of responses to vary in width as a function of distance to the nearest cardinal (regardless of whether the bins are centered at the cardinal or at the oblique, the width of the response distribution usually increases as the distance to cardinals increase).</p></li>
<li><p>Choose the best-fitting model between the one using cardinal and the one using oblique bins.</p></li>
<li><p>Compute the residuals of the best-fitting model - that's your bias-corrected error - and the biases (see below).</p></li>
</ol><p>The bias is computed by flipping the sign of errors when the average predicted error is negative, so, that, for example, if on average the responses are shifted clockwise relative to the true values, the trial-by-trial error would count as bias when it is also shifted clockwise.</p>
<p>If bias_type is set to 'obl' or 'card', only one set of bins is used, centred at cardinal or oblique angles, respectively.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># Data in orientation domain from Pascucci et al. (2019, PLOS Bio),</span></span>
<span class="r-in"><span class="co"># https://doi.org/10.5281/zenodo.2544946</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">Pascucci_et_al_2019_data</span><span class="op">[</span><span class="va">observer</span><span class="op">==</span><span class="fl">4</span>, <span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">err</span>, <span class="va">orientation</span>, do_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: patchwork</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘patchwork’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:MASS’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     area</span>
<span class="r-plt img"><img src="remove_cardinal_biases-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      is_outlier        pred        be_c which_bin bias bias_type    pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:          0  7.61511861  -4.6151186         2    3       obl   7.8012240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:          0  0.01464459   0.9853554         2    1       obl  -0.4583498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:          0  1.57619824  -4.5761982         2   -3       obl   0.6074016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:          0 -7.99617928   9.9961793         1   -2       obl  -9.7661382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:          0 -9.02293124   1.0229312         2    8       obl  -6.3199829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 436:          0 -3.77707309   2.7770731         1    1       obl  -1.2667688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 437:          0 -8.73979472 -10.2602053         2   19       obl -11.3823023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 438:          1 -8.00644915  22.0064492         2  -14       obl  -5.5206693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 439:          0  1.94308815  -2.9430882         2   -1       obl   0.8738395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 440:          0 -1.66717180   0.6671718         2    1       obl  -1.5241013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pred_sigma coef_sigma_int coef_sigma_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:   6.512993       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:   7.543931       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:   7.467866       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:   6.259090       1.831048     0.0004266147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:   6.748150       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 436:   6.331603       1.831048     0.0004266147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 437:   6.128773       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 438:   6.851513       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 439:   7.430121       1.797793     0.0050670450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 440:   7.392568       1.797793     0.0050670450</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Data in motion domain from Bae &amp; Luck (2018, Neuroimage), https://osf.io/2h6w9/</span></span>
<span class="r-in"><span class="va">Bae_Luck_2018_data</span><span class="op">[</span><span class="va">subject_Num</span> <span class="op">==</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subject_Num</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,</span>
<span class="r-in"><span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">err</span>, <span class="va">TargetDirection</span>, space <span class="op">=</span> <span class="st">'360'</span>, do_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There is a discrepancy  between the original and the re-fit </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  used to achieve 'safe' predictions </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-plt img"><img src="remove_cardinal_biases-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       is_outlier       pred         be_c which_bin    bias bias_type  pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:          1 -9.3654115  178.7654115         1 -169.40       obl -4.721015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:          0 -2.9754759   -3.0245241         1    6.00       obl -4.189975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:          1 -5.0711403  182.6211403         1 -177.55       obl -3.757276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:          0 -9.6351780  -31.3648220         1   41.00       obl -4.957033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:          1 -4.6613521 -170.2886479         4  174.95       obl -8.544710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:          0 -5.4649867   -0.5350133         4    6.00       obl -2.399848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:          0 -1.2347871    3.2347871         3   -2.00       obl -1.006986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:          0 -0.6550139  -12.6449861         3   13.30       obl -3.046211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:          0 -2.3714867    9.3714867         1   -7.00       obl -3.914621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:          1  3.7430472 -179.9430472         2 -176.20       obl 10.585121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pred_sigma coef_sigma_int coef_sigma_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:   13.15107       2.738580     -0.004502117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:   13.69488       2.738580     -0.004502117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:   15.12076       2.738580     -0.004502117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:   13.88111       2.738580     -0.004502117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   14.58627       2.675535      0.002272586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:   15.47410       2.675535      0.002272586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:   27.72277       2.502993      0.021616388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:   13.46733       2.502993      0.021616388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:   14.58585       2.738580     -0.004502117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:   13.88315       2.548749      0.013654507</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrey Chetverikov.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

