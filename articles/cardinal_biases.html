<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Correcting for cardinal biases to improve serial dependence estimates • circhelp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correcting for cardinal biases to improve serial dependence estimates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">circhelp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cardinal_biases.html">Correcting for cardinal biases to improve serial dependence estimates</a></li>
    <li><a class="dropdown-item" href="../articles/serial_dependence_with_density_asymmetry.html">Estimating serial dependence with density_asymmetry()</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/achetverikov/circhelp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Correcting for cardinal biases to improve serial dependence estimates</h1>
            
            <h4 data-toc-skip class="date">Publication Date:
01/03/2022<br>Last updated: 04/10/2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/achetverikov/circhelp/blob/main/vignettes/cardinal_biases.Rmd" class="external-link"><code>vignettes/cardinal_biases.Rmd</code></a></small>
      <div class="d-none name"><code>cardinal_biases.Rmd</code></div>
    </div>

    
    
<p>This is a small vignette showing how correcting for cardinal biases
might improve serial dependence (SD) estimates. I will use the data from
Experiment 2 in Pascucci et al. (2019, PLOS Biology, <a href="https://dx.doi.org/10.1371/journal.pbio.3000144" class="external-link uri">https://dx.doi.org/10.1371/journal.pbio.3000144</a>)
available from <a href="https://doi.org/10.5281/zenodo.2544946" class="external-link uri">https://doi.org/10.5281/zenodo.2544946</a>. First, I load
the data, the required packages, and compute important variables.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the data</span></span>
<span><span class="co"># data &lt;- fread('https://zenodo.org/record/2544946/files/Experiment2_rawdata.csv?download=1')</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">Pascucci_et_al_2019_data</span></span>
<span><span class="va">data</span><span class="op">[</span>, <span class="va">err</span> <span class="op">:=</span> <span class="fu"><a href="../reference/angle_diff_rad.html">angle_diff_180</a></span><span class="op">(</span><span class="va">reported</span>, <span class="va">orientation</span><span class="op">)</span><span class="op">]</span> <span class="co"># response errors</span></span>
<span><span class="va">data</span><span class="op">[</span>, <span class="va">prev_ori</span> <span class="op">:=</span> <span class="fu">shift</span><span class="op">(</span><span class="va">orientation</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">observer</span><span class="op">]</span> <span class="co"># orientation on previous trial</span></span>
<span><span class="va">data</span><span class="op">[</span>, <span class="va">diff_in_ori</span> <span class="op">:=</span> <span class="fu"><a href="../reference/angle_diff_rad.html">angle_diff_180</a></span><span class="op">(</span><span class="va">prev_ori</span>, <span class="va">orientation</span><span class="op">)</span><span class="op">]</span> <span class="co"># shift in orientations between trials</span></span></code></pre></div>
<p>The responses in this data show a typical SD pattern with a bias
towards previous orientations. I use the <code>pad_circ</code> function
to account for circularity in the data when smoothing. It adds part of
the data from one end to another end of the variable range (e.g., the
data with the relative orientation from 60 to 90° are copied and pasted
to the data set with the new relative orientation values of -120 to
90°). This is not the perfect way to account for circularity, but it is
good enough for this kind of analysis. The thin lines show individual
observers, and the thick blue line shows the average.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="../reference/pad_circ.html">pad_circ</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"diff_in_ori"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_in_ori</span>, y <span class="op">=</span> <span class="va">err</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">observer</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"smooth"</span>, size <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">T</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Error, °"</span>, x <span class="op">=</span> <span class="st">"Orientation difference, °"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="cardinal_biases_files/figure-html/serial_dependence-1.png" width="40%" height="40%"></p>
<p>But SD is not the only bias present. The orientation estimates
usually show cardinal biases, that is, a repulsion effect with responses
“repulsed away” from cardinal orientations. Here is an example observer
where this pattern is clearly seen.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">observer</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/angle_diff_rad.html">angle_diff_180</a></span><span class="op">(</span><span class="va">orientation</span>, <span class="fl">0</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">err</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Error, °"</span>, x <span class="op">=</span> <span class="st">"Orientation, °"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cardinal_biases_files/figure-html/card_biases_ex-1.png" width="40%" height="40%"></p>
<p>Cardinal biases (like any other biases) not only add noise to the
data but can also mimic other biases, such as SD. For example, if an
observer is presented with an 8° line followed by a 2° line, the
estimates of the 2° line would be pushed towards 8° because of the
cardinal bias, not solely because of SD. It’s not necessarily a problem
for a well-balanced design, but it’s better to remove them to be on the
safe side.</p>
<p>remove_cardinal_biases removes the cardinal biases and other similar
orientation-dependent idiosyncrasies by fitting a set of polynomials to
the data and computing the residuals. In other words, it tries to
predict how the errors change on average with changes in orientation and
removes that dependence. Additionally, it tries to estimate which
responses are outliers while accounting for changes in response variance
across orientations (see more in
<code><a href="../reference/remove_cardinal_biases.html">remove_cardinal_biases()</a></code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_subj_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">observer</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">]</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_cardinal_biases.html">remove_cardinal_biases</a></span><span class="op">(</span><span class="va">ex_subj_data</span><span class="op">$</span><span class="va">err</span>, <span class="va">ex_subj_data</span><span class="op">$</span><span class="va">orientation</span>, plots <span class="op">=</span> <span class="st">"show"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cardinal_biases_files/figure-html/correct_biases_ex-1.png" width="100%" height="40%"></p>
<p>To illustrate how it works, we can plot some output from this
function. The first plot shows the errors the same way as in the
previous plot but adds the fitted polynomials to them. The second one
shows the errors with the biases removed. The third one plots only the
bias (disregarding the sign of the average error).</p>
<p>Then, we can check how SD estimates are affected by the removal of
cardinal biases. For the sake of completeness, I also show the result of
removing the mean error only (which is close to nothing).</p>
<p>First, for each observer, I compute a corrected error and find the
trials likely to be the outliers. <code>remove_cardinal_biases</code>
returns a <code>data.table</code> object with multiple columns with the
most commonly used ones being the bias-corrected error
(<code>be_c</code>) and an outlier marker (<code>is_outlier</code>). I
save them in the <code>data</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"err_corrected"</span>, <span class="st">"is_outlier"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="../reference/remove_cardinal_biases.html">remove_cardinal_biases</a></span><span class="op">(</span><span class="va">err</span>, <span class="va">orientation</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"be_c"</span>, <span class="st">"is_outlier"</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">observer</span><span class="op">]</span></span></code></pre></div>
<p>As a comparison, we can just use a correction for the overall mean
error.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span>, <span class="va">err_mean_corrected</span> <span class="op">:=</span> <span class="fu"><a href="../reference/angle_diff_rad.html">angle_diff_180</a></span><span class="op">(</span><span class="va">err</span>, <span class="fu"><a href="../reference/circ_mean_rad.html">circ_mean_180</a></span><span class="op">(</span><span class="va">err</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">observer</span><span class="op">]</span></span></code></pre></div>
<p>Then, I plot these errors along with the raw errors as a function of
the previous item orientation (with the outliers removed) and plot
them.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datam</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff_in_ori</span><span class="op">)</span><span class="op">]</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diff_in_ori"</span>, <span class="st">"observer"</span>, <span class="st">"is_outlier"</span><span class="op">)</span>, measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"err"</span>, <span class="st">"err_corrected"</span>, <span class="st">"err_mean_corrected"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datam</span><span class="op">[</span>, <span class="va">variablef</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">variable</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"err"</span>, <span class="st">"err_mean_corrected"</span>, <span class="st">"err_corrected"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Raw error"</span>, <span class="st">"Mean-corrected"</span>, <span class="st">"Mean and cardinal bias removed"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">datam</span><span class="op">[</span>, <span class="va">err_rel_to_prev_targ</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">diff_in_ori</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="op">-</span><span class="va">value</span>, <span class="va">value</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="../reference/pad_circ.html">pad_circ</a></span><span class="op">(</span><span class="va">datam</span><span class="op">[</span><span class="va">is_outlier</span> <span class="op">==</span> <span class="cn">F</span><span class="op">]</span>, <span class="st">"diff_in_ori"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff_in_ori</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">observer</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"smooth"</span>, size <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">variablef</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Error, °"</span>, x <span class="op">=</span> <span class="st">"Orientation difference, °"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="cardinal_biases_files/figure-html/unnamed-chunk-4-1.png" width="100%" height="40%"></p>
<p>To make things clearer, I plot serial dependence as a function of
absolute orientation differences.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">datam</span><span class="op">[</span><span class="va">is_outlier</span> <span class="op">==</span> <span class="cn">F</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">diff_in_ori</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">err_rel_to_prev_targ</span>,</span>
<span>  color <span class="op">=</span> <span class="va">variablef</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">2</span>, yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">variablef</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Bias towards previous targets"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Absolute orientation difference, °"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="cardinal_biases_files/figure-html/unnamed-chunk-5-1.png" width="100%" height="40%"></p>
<p>As you can see, when estimated using error corrected for cardinal
bias, SD looks “better” in the sense that around zero (where no bias is
expected), the SD is closer to zero, and there is also less of a bump
around 90° (this bump is probably a result of the large error
variability / fewer data points in this dataset). Correcting for
cardinal biases also reduces the variability of the errors, making the
SD effect more pronounced. But note also that the confidence intervals
in these plots are not quite right as they do not account for
between-subject and within-subject variability properly. A better
approach is to bin the data or to smooth the data by subject and then
compute the confidence intervals. These approaches are illustrated in
<code><a href="../articles/serial_dependence_with_density_asymmetry.html">vignette('serial_dependence_with_density_asymmetry')</a></code>.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrey Chetverikov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
