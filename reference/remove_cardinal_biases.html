<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Remove cardinal biases — remove_cardinal_biases • circhelp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Remove cardinal biases — remove_cardinal_biases"><meta name="description" content="Remove cardinal biases"><meta property="og:description" content="Remove cardinal biases"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">circhelp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cardinal_biases.html">Correcting for cardinal biases to improve serial dependence estimates</a></li>
    <li><a class="dropdown-item" href="../articles/serial_dependence_with_density_asymmetry.html">Estimating serial dependence with density_asymmetry()</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/achetverikov/circhelp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Remove cardinal biases</h1>
      <small class="dont-index">Source: <a href="https://github.com/achetverikov/circhelp/blob/main/R/functions.R" class="external-link"><code>R/functions.R</code></a></small>
      <div class="d-none name"><code>remove_cardinal_biases.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Remove cardinal biases</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">remove_cardinal_biases</span><span class="op">(</span></span>
<span>  <span class="va">err</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  space <span class="op">=</span> <span class="st">"180"</span>,</span>
<span>  bias_type <span class="op">=</span> <span class="st">"fit"</span>,</span>
<span>  plots <span class="op">=</span> <span class="st">"hide"</span>,</span>
<span>  poly_deg <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  var_sigma <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  var_sigma_poly_deg <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  reassign_at_boundaries <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reassign_range <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  break_points <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  init_outliers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  do_plots <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-err">err<a class="anchor" aria-label="anchor" href="#arg-err"></a></dt>
<dd><p>a vector of errors, deviations of response from the true stimuli</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector of true stimuli in degrees (see space)</p></dd>


<dt id="arg-space">space<a class="anchor" aria-label="anchor" href="#arg-space"></a></dt>
<dd><p>circular space to use (a string: <code>180</code> or <code>360</code>)</p></dd>


<dt id="arg-bias-type">bias_type<a class="anchor" aria-label="anchor" href="#arg-bias-type"></a></dt>
<dd><p>bias type to use (<code>fit</code>, <code>card</code>, <code>obl</code>, or <code>custom</code>, see details)</p></dd>


<dt id="arg-plots">plots<a class="anchor" aria-label="anchor" href="#arg-plots"></a></dt>
<dd><p>a string <code>hide</code>, <code>show</code>, or <code>return</code> to hide, show, or return plots (default: <code>hide</code>)</p></dd>


<dt id="arg-poly-deg">poly_deg<a class="anchor" aria-label="anchor" href="#arg-poly-deg"></a></dt>
<dd><p>degree of the fitted polynomials for each bin (default: 4)</p></dd>


<dt id="arg-var-sigma">var_sigma<a class="anchor" aria-label="anchor" href="#arg-var-sigma"></a></dt>
<dd><p>allow standard deviation (width) of the fitted response distribution to vary as a function of distance to the nearest cardinal (default: True)</p></dd>


<dt id="arg-var-sigma-poly-deg">var_sigma_poly_deg<a class="anchor" aria-label="anchor" href="#arg-var-sigma-poly-deg"></a></dt>
<dd><p>degree of the fitted polynomials for each bin for the first approximation for the response distribution to select the best fitting model (default: 4)</p></dd>


<dt id="arg-reassign-at-boundaries">reassign_at_boundaries<a class="anchor" aria-label="anchor" href="#arg-reassign-at-boundaries"></a></dt>
<dd><p>select the bin for the observations at the boundaries between bins based on the best-fitting polynomial (default: True)</p></dd>


<dt id="arg-reassign-range">reassign_range<a class="anchor" aria-label="anchor" href="#arg-reassign-range"></a></dt>
<dd><p>maximum distance to the boundary at which reassignment can occur (default: 2 degrees)</p></dd>


<dt id="arg-break-points">break_points<a class="anchor" aria-label="anchor" href="#arg-break-points"></a></dt>
<dd><p>can be used to assign custom break points instead of cardinal/oblique ones with <code>bias_type</code> set to <code>custom</code> (default: NULL)</p></dd>


<dt id="arg-init-outliers">init_outliers<a class="anchor" aria-label="anchor" href="#arg-init-outliers"></a></dt>
<dd><p>a vector determining which errors are initially assumed to be outliers (default: NULL)</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>print some extra info (default: False)</p></dd>


<dt id="arg-do-plots">do_plots<a class="anchor" aria-label="anchor" href="#arg-do-plots"></a></dt>
<dd><p>deprecated, use the parameter <code>plots</code> instead</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>plots=='return'</code>, returns the three plots showing the biases
(combined together with <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>). Otherwise, returns a list with the following elements:</p><ul><li><p>is_outlier - 0 for outliers (defined as <code>±3*pred_sigma</code> for the model with varying sigma or as <code>±3\*SD</code> for the simple model)</p></li>
<li><p>pred predicted error</p></li>
<li><p>be_c error corrected for biases (<code>be_c = observed error - pred</code>)</p></li>
<li><p>which_bin the numeric ID of the bin that the stimulus belong to</p></li>
<li><p>bias the bias computed as described above</p></li>
<li><p>bias_typ bias type (cardinal or oblique)</p></li>
<li><p>pred_lin predicted error for a simple linear model for comparison</p></li>
<li><p>pred_sigma predicted SD of the error distribution</p></li>
<li><p>coef_sigma_int, coef_sigma_slope intercept and slope for the sigma prediction</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the <code>bias_type</code> is set to <code>fit</code>, the function computes the cardinal biases in the following way:</p><ol><li><p>Create two sets of bins, splitting the stimuli vector into bins centered at cardinal and at oblique directions.</p></li>
<li><p>For each set of bins, fit a nth-degree polynomial for the responses in each bin, optionally allowing the distribution of responses to vary in width as a function of distance to the nearest cardinal (regardless of whether the bins are centered at the cardinal or at the oblique, the width of the response distribution usually increases as the distance to cardinals increase).</p></li>
<li><p>Choose the best-fitting model between the one using cardinal and the one using oblique bins.</p></li>
<li><p>Compute the residuals of the best-fitting model - that's your bias-corrected error - and the biases (see below).</p></li>
</ol><p>The bias is computed by flipping the sign of errors when the average predicted error is negative, so, that, for example, if on average the responses are shifted clockwise relative to the true values, the trial-by-trial error would count as bias when it is also shifted clockwise.</p>
<p>If <code>bias_type</code> is set to <code>obl</code> or <code>card</code>, only one set of bins is used, centred at cardinal or oblique angles, respectively.</p>
<p>For additional examples see the help vignette:
<code><a href="../articles/cardinal_biases.html">vignette("cardinal_biases", package = "circhelp")</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p><ul><li><p>Chetverikov, A., &amp; Jehee, J. F. M. (2023). Motion direction is represented as a bimodal probability distribution in the human visual cortex. Nature Communications, 14(7634). <a href="https://doi.org/10.1038/s41467-023-43251-w" class="external-link">doi:10.1038/s41467-023-43251-w</a></p></li>
<li><p>van Bergen, R. S., Ma, W. J., Pratte, M. S., &amp; Jehee, J. F. M. (2015). Sensory uncertainty decoded from visual cortex predicts behavior. Nature Neuroscience, 18(12), 1728–1730. <a href="https://doi.org/10.1038/nn.4150" class="external-link">doi:10.1038/nn.4150</a></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data in orientation domain from Pascucci et al. (2019, PLOS Bio),</span></span></span>
<span class="r-in"><span><span class="co"># https://doi.org/10.5281/zenodo.2544946</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex_data</span> <span class="op">&lt;-</span> <span class="va">Pascucci_et_al_2019_data</span><span class="op">[</span><span class="va">observer</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">ex_data</span><span class="op">$</span><span class="va">err</span>, <span class="va">ex_data</span><span class="op">$</span><span class="va">orientation</span>, plots <span class="op">=</span> <span class="st">"show"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="remove_cardinal_biases-1.png" alt="" width="1760" height="880"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      is_outlier       pred        be_c which_bin  bias bias_type    pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;num&gt;      &lt;num&gt;       &lt;num&gt;     &lt;num&gt; &lt;num&gt;    &lt;char&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:          0  7.9231406  -4.9231406         2     3       obl   7.7417971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:          0 -0.1308394   1.1308394         2    -1       obl  -0.3993174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:          0  1.2207704  -4.2207704         2    -3       obl   0.6511490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:          0 -8.7810566  10.7810566         1    -2       obl  -9.8423470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:          0 -8.6973985   0.6973985         2     8       obl  -6.1768825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 436:          0 -2.1183875   1.1183875         1     1       obl  -1.2501447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 437:          0 -8.6734938 -10.3265062         2    19       obl -11.1665978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 438:          1 -7.5719139  21.5719139         2   -14       obl  -5.3890327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 439:          0  1.5455219  -2.5455219         2    -1       obl   0.9137656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 440:          0 -1.5454397   0.5454397         2     1       obl  -1.4497838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pred_sigma coef_sigma_int coef_sigma_slope shifted_x total_log_lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;num&gt;          &lt;num&gt;            &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:   6.581614       2.008436    -0.0041385327        15     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:   7.420878       2.008436    -0.0041385327        46     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:   7.359709       2.008436    -0.0041385327        42     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:   6.048106       1.835112    -0.0009307184        -7     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:   6.775070       2.008436    -0.0041385327        68     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 436:   6.202017       1.835112    -0.0009307184       -34     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 437:   6.262739       2.008436    -0.0041385327        87     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 438:   6.859711       2.008436    -0.0041385327        65     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 439:   7.329313       2.008436    -0.0041385327        41     -1439.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 440:   7.299043       2.008436    -0.0041385327        50     -1439.084</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data in motion domain from Bae &amp; Luck (2018, Neuroimage),</span></span></span>
<span class="r-in"><span><span class="co"># https://osf.io/2h6w9/</span></span></span>
<span class="r-in"><span><span class="va">ex_data_bae</span> <span class="op">&lt;-</span> <span class="va">Bae_Luck_2018_data</span><span class="op">[</span><span class="va">subject_Num</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subject_Num</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">ex_data_bae</span><span class="op">$</span><span class="va">err</span>, <span class="va">ex_data_bae</span><span class="op">$</span><span class="va">TargetDirection</span>,</span></span>
<span class="r-in"><span>  space <span class="op">=</span> <span class="st">"360"</span>, plots <span class="op">=</span> <span class="st">"show"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="remove_cardinal_biases-2.png" alt="" width="1760" height="880"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       is_outlier       pred        be_c which_bin    bias bias_type    pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;      &lt;num&gt;       &lt;num&gt;     &lt;num&gt;   &lt;num&gt;    &lt;char&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:          1  -8.170082  177.570082         4 -169.40       obl  -4.9493375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:          0  -4.274308   -1.725692         4    6.00       obl  -3.4904611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:          1  -1.536582  179.086582         4 -177.55       obl  -2.3017470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:          0  -8.127875  -32.872125         4   41.00       obl  -5.5977270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:          1 -12.621761 -162.328239         3  174.95       obl -10.0644723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:          0  -3.467410   -2.532590         3    6.00       obl  -3.1784946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:          0  -0.857953    2.857953         2   -2.00       obl  -0.9756321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:          0  -1.282251  -12.017749         2   13.30       obl  -2.8733208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:          0  -2.482519    9.482519         4   -7.00       obl  -2.7340066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:          1   5.470358 -181.670358         1 -176.20       obl  10.9248285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pred_sigma coef_sigma_int coef_sigma_slope shifted_x total_log_lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;          &lt;num&gt;            &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:   13.29616       2.556561     0.0034349606     234.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:   13.71362       2.556561     0.0034349606     207.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:   14.79011       2.556561     0.0034349606     185.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:   13.85567       2.556561     0.0034349606     246.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   15.11852       2.757918    -0.0009766969     178.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:   15.50735       2.757918    -0.0009766969     152.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:   27.85360       3.482895    -0.0219623385      52.1     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:   13.37544       3.482895    -0.0219623385      85.5     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:   14.38922       2.556561     0.0034349606     193.0     -4999.393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:   14.03739       3.163758    -0.0133854689     -84.0     -4999.393</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using a stricter initial outlier boundary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">ex_data_bae</span><span class="op">$</span><span class="va">err</span>, <span class="va">ex_data_bae</span><span class="op">$</span><span class="va">TargetDirection</span>,</span></span>
<span class="r-in"><span>  space <span class="op">=</span> <span class="st">"360"</span>, plots <span class="op">=</span> <span class="st">"show"</span>,</span></span>
<span class="r-in"><span>  init_outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ex_data_bae</span><span class="op">$</span><span class="va">err</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="remove_cardinal_biases-3.png" alt="" width="1760" height="880"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       is_outlier       pred        be_c which_bin    bias bias_type  pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;      &lt;num&gt;       &lt;num&gt;     &lt;num&gt;   &lt;num&gt;    &lt;char&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:          1  -9.113946  178.513946         4 -169.40       obl -4.710449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:          0  -2.806203   -3.193797         4    6.00       obl -3.476563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:          1  -2.094947  179.644947         4 -177.55       obl -2.471175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:          1  -8.951250  -32.048750         4   41.00       obl -5.258842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:          1 -11.247061 -163.702939         3  174.95       obl -9.952609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:          0  -4.297750   -1.702250         3    6.00       obl -3.147991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:          0  -3.552364    5.552364         2   -2.00       obl -1.006986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:          0  -1.312257  -11.987743         2   13.30       obl -3.046211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:          0  -1.224265    8.224265         4   -7.00       obl -2.836771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:          1   6.492975 -182.692975         1 -176.20       obl 11.762122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pred_sigma coef_sigma_int coef_sigma_slope shifted_x total_log_lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;          &lt;num&gt;            &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:   9.563944       2.296165     -0.004240535     234.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:   9.205815       2.296165     -0.004240535     207.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:   8.385832       2.296165     -0.004240535     185.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:   9.089444       2.296165     -0.004240535     246.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   9.677623       2.137990      0.003065721     178.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:   8.936174       2.137990      0.003065721     152.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:   7.358394       1.892981      0.014487437      52.1     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:  11.937946       1.892981      0.014487437      85.5     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:   8.675195       2.296165     -0.004240535     193.0     -4106.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:   7.510183       1.892083      0.003184029     -84.0     -4106.563</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can also use just one bin by setting `bias_type` to custom</span></span></span>
<span class="r-in"><span><span class="co"># and setting the `break_points` at the ends of the range for x</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">remove_cardinal_biases</span><span class="op">(</span><span class="va">ex_data_bae</span><span class="op">$</span><span class="va">err</span>, <span class="va">ex_data_bae</span><span class="op">$</span><span class="va">TargetDirection</span>,</span></span>
<span class="r-in"><span>  space <span class="op">=</span> <span class="st">"360"</span>, bias_type <span class="op">=</span> <span class="st">"custom"</span>,</span></span>
<span class="r-in"><span>  break_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span>, plots <span class="op">=</span> <span class="st">"show"</span>,</span></span>
<span class="r-in"><span>  reassign_at_boundaries <span class="op">=</span> <span class="cn">FALSE</span>, poly_deg <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>  init_outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ex_data_bae</span><span class="op">$</span><span class="va">err</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="remove_cardinal_biases-4.png" alt="" width="1760" height="880"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       is_outlier       pred         be_c which_bin    bias bias_type   pred_lin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;      &lt;num&gt;        &lt;num&gt;     &lt;num&gt;   &lt;num&gt;    &lt;char&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:          1 -9.3547551  178.7547551         1 -169.40    custom -0.3342663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:          0 -2.5809200   -3.4190800         1    6.00    custom -0.3327065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:          1 -4.4192576  181.9692576         1 -177.55    custom -0.3314355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:          1 -9.5398446  -31.4601554         1   41.00    custom -0.3349595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:          1 -7.0169649 -167.9330351         1  174.95    custom -0.3310311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:          0 -5.0038536   -0.9961464         1    6.00    custom -0.3295290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:          0 -3.9178042    5.9178042         1   -2.00    custom -0.3237577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:          0  0.6855594  -13.9855594         1  -13.30    custom -0.3256872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:          0 -1.6660057    8.6660057         1   -7.00    custom -0.3318977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:          1  4.0545242 -180.2545242         1 -176.20    custom -0.3366927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pred_sigma coef_sigma_int coef_sigma_slope shifted_x total_log_lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;          &lt;num&gt;            &lt;num&gt;     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:   8.778540       2.164489     0.0001448273    -126.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:   8.744280       2.164489     0.0001448273    -153.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:   8.716463       2.164489     0.0001448273    -175.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:   8.793810       2.164489     0.0001448273    -114.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   8.712677       2.164489     0.0001448273    -182.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1276:   8.745546       2.164489     0.0001448273    -208.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1277:   8.872999       2.164489     0.0001448273    -307.9     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1278:   8.830182       2.164489     0.0001448273    -274.5     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1279:   8.726568       2.164489     0.0001448273    -167.0     -4139.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1280:   8.832100       2.164489     0.0001448273     -84.0     -4139.606</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrey Chetverikov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

